CustomOAuth2UserService.loadUser()
is instantiating constructor of CustomOAuth2User.java
getAuthorities() is getting called in CustomOAuth2User.java to check roles.

UserService.java is getting used in both OAuth and Form Login.